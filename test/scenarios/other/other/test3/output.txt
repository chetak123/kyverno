I0818 08:40:03.248399  776972 logr.go:261]  "msg"="unable to cache OpenAPISchema"  "definitionName"="io.k8s.api.authentication.v1.TokenRequest" "reason"="gvk not found by the given definition name io.k8s.api.authentication.v1.TokenRequest, [v1/TokenRequest]"
I0818 08:40:03.248517  776972 logr.go:261]  "msg"="unable to cache OpenAPISchema"  "definitionName"="io.k8s.api.autoscaling.v1.Scale" "reason"="gvk not found by the given definition name io.k8s.api.autoscaling.v1.Scale, [v1/Scale apps/v1/Scale apps/v1/Scale apps/v1/Scale]"
I0818 08:40:03.248580  776972 logr.go:261]  "msg"="unable to cache OpenAPISchema"  "definitionName"="io.k8s.api.batch.v1.CronJob" "reason"="gvk not found by the given definition name io.k8s.api.batch.v1.CronJob, [batch/v1beta1/CronJob]"
I0818 08:40:03.248779  776972 logr.go:261]  "msg"="unable to cache OpenAPISchema"  "definitionName"="io.k8s.api.discovery.v1.EndpointSlice" "reason"="gvk not found by the given definition name io.k8s.api.discovery.v1.EndpointSlice, [discovery.k8s.io/v1beta1/EndpointSlice]"
I0818 08:40:03.248883  776972 logr.go:261]  "msg"="unable to cache OpenAPISchema"  "definitionName"="io.k8s.api.node.v1alpha1.RuntimeClass" "reason"="gvk not found by the given definition name io.k8s.api.node.v1alpha1.RuntimeClass, [node.k8s.io/v1/RuntimeClass node.k8s.io/v1beta1/RuntimeClass]"
I0818 08:40:03.248917  776972 logr.go:261]  "msg"="unable to cache OpenAPISchema"  "definitionName"="io.k8s.api.policy.v1.PodDisruptionBudget" "reason"="gvk not found by the given definition name io.k8s.api.policy.v1.PodDisruptionBudget, [policy/v1beta1/PodDisruptionBudget]"
I0818 08:40:03.248958  776972 logr.go:261]  "msg"="unable to cache OpenAPISchema"  "definitionName"="io.k8s.api.policy.v1beta1.Eviction" "reason"="gvk not found by the given definition name io.k8s.api.policy.v1beta1.Eviction, [v1/Eviction]"
I0818 08:40:03.249024  776972 logr.go:261]  "msg"="unable to cache OpenAPISchema"  "definitionName"="io.k8s.api.rbac.v1alpha1.ClusterRole" "reason"="gvk not found by the given definition name io.k8s.api.rbac.v1alpha1.ClusterRole, [rbac.authorization.k8s.io/v1/ClusterRole rbac.authorization.k8s.io/v1beta1/ClusterRole]"
I0818 08:40:03.249052  776972 logr.go:261]  "msg"="unable to cache OpenAPISchema"  "definitionName"="io.k8s.api.rbac.v1alpha1.ClusterRoleBinding" "reason"="gvk not found by the given definition name io.k8s.api.rbac.v1alpha1.ClusterRoleBinding, [rbac.authorization.k8s.io/v1/ClusterRoleBinding rbac.authorization.k8s.io/v1beta1/ClusterRoleBinding]"
I0818 08:40:03.249081  776972 logr.go:261]  "msg"="unable to cache OpenAPISchema"  "definitionName"="io.k8s.api.rbac.v1alpha1.Role" "reason"="gvk not found by the given definition name io.k8s.api.rbac.v1alpha1.Role, [rbac.authorization.k8s.io/v1/Role rbac.authorization.k8s.io/v1beta1/Role]"
I0818 08:40:03.249107  776972 logr.go:261]  "msg"="unable to cache OpenAPISchema"  "definitionName"="io.k8s.api.rbac.v1alpha1.RoleBinding" "reason"="gvk not found by the given definition name io.k8s.api.rbac.v1alpha1.RoleBinding, [rbac.authorization.k8s.io/v1/RoleBinding rbac.authorization.k8s.io/v1beta1/RoleBinding]"
I0818 08:40:03.249151  776972 logr.go:261]  "msg"="unable to cache OpenAPISchema"  "definitionName"="io.k8s.api.scheduling.v1alpha1.PriorityClass" "reason"="gvk not found by the given definition name io.k8s.api.scheduling.v1alpha1.PriorityClass, [scheduling.k8s.io/v1/PriorityClass scheduling.k8s.io/v1beta1/PriorityClass]"
I0818 08:40:03.249191  776972 logr.go:261]  "msg"="unable to cache OpenAPISchema"  "definitionName"="io.k8s.api.storage.v1.TokenRequest" "reason"="gvk not found by the given definition name io.k8s.api.storage.v1.TokenRequest, [v1/TokenRequest]"
I0818 08:40:03.249225  776972 logr.go:261]  "msg"="unable to cache OpenAPISchema"  "definitionName"="io.k8s.api.storage.v1alpha1.VolumeAttachment" "reason"="gvk not found by the given definition name io.k8s.api.storage.v1alpha1.VolumeAttachment, [storage.k8s.io/v1/VolumeAttachment storage.k8s.io/v1beta1/VolumeAttachment]"
I0818 08:40:03.249261  776972 logr.go:261]  "msg"="unable to cache OpenAPISchema"  "definitionName"="io.k8s.api.storage.v1beta1.TokenRequest" "reason"="gvk not found by the given definition name io.k8s.api.storage.v1beta1.TokenRequest, [v1/TokenRequest]"
I0818 08:40:03.254706  776972 logr.go:261]  "msg"="Defaulting request.operation to CREATE"  
I0818 08:40:03.254743  776972 logr.go:261]  "msg"="reading policies"  "path"="../../../../../test/policy/mutate/policy_mutate_validate_qos.yaml"
I0818 08:40:03.255473  776972 logr.go:261]  "msg"="read policies"  "errors"=0 "policies"=1
I0818 08:40:03.255524  776972 policymutation.go:74] apply "msg"="setting default value"  "spec.validationFailureAction"="audit"
I0818 08:40:03.255560  776972 policymutation.go:80] apply "msg"="generated JSON Patch to set default"  "spec.validationFailureAction"="audit"
I0818 08:40:03.255581  776972 policymutation.go:58] apply "msg"="setting default value"  "spec.background"=true
I0818 08:40:03.255601  776972 policymutation.go:64] apply "msg"="generated JSON Patch to set default"  "spec.background"=true
I0818 08:40:03.255618  776972 policymutation.go:90] apply "msg"="setting default value"  "spec.failurePolicy"="Fail"
I0818 08:40:03.255639  776972 policymutation.go:96] apply "msg"="generated JSON Patch to set default"  "spec.failurePolicy"="Fail"
I0818 08:40:03.255659  776972 logr.go:261] autogen "msg"="skip generating rule on pod controllers: Name / Selector in resource description may not be applicable."  "rule"="add-memory-limit"
I0818 08:40:03.256018  776972 logr.go:261]  "msg"="mutated Policy:"  "{\"kind\":\"ClusterPolicy\",\"apiVersion\":\"kyverno.io/v1\",\"metadata\":{\"name\":\"policy-qos\",\"creationTimestamp\":null,\"annotations\":{\"pod-policies.kyverno.io/autogen-controllers\":\"none\"}},\"spec\":{\"rules\":[{\"name\":\"add-memory-limit\",\"match\":{\"resources\":{\"kinds\":[\"Deployment\"],\"selector\":{\"matchLabels\":{\"test\":\"qos\"}}}},\"exclude\":{\"resources\":{}},\"mutate\":{\"patchStrategicMerge\":{\"spec\":{\"template\":{\"spec\":{\"containers\":[{\"(name)\":\"*\",\"resources\":{\"limits\":{\"+(cpu)\":\"100\",\"+(memory)\":\"300Mi\"}}}]}}}}},\"validate\":{},\"generate\":{\"clone\":{}}},{\"name\":\"check-cpu-memory-limits\",\"match\":{\"resources\":{\"kinds\":[\"Deployment\"],\"selector\":{\"matchLabels\":{\"test\":\"qos\"}}}},\"exclude\":{\"resources\":{}},\"mutate\":{},\"validate\":{\"message\":\"Resource limits are required for CPU and memory\",\"pattern\":{\"spec\":{\"template\":{\"spec\":{\"containers\":[{\"(name)\":\"*\",\"resources\":{\"limits\":{\"cpu\":\"?*\",\"memory\":\"?*\"}}}]}}}}},\"generate\":{\"clone\":{}}}],\"failurePolicy\":\"Fail\",\"validationFailureAction\":\"audit\",\"background\":true},\"status\":{\"ready\":false,\"autogen\":{}}}"="(MISSING)"
I0818 08:40:03.258849  776972 strategicMergePatch.go:21] EngineForceMutate/ProcessStrategicMergePatch "msg"="started applying strategicMerge patch" "kind"="Deployment" "name"="" "namespace"="" "policy"="policy-qos" "rule"="add-memory-limit" "startTime"="2022-08-18T08:40:03.258794495+05:30"
I0818 08:40:03.261493  776972 strategicMergePatch.go:100] EngineForceMutate/ProcessStrategicMergePatch "msg"="applying strategic merge patch" "kind"="Deployment" "name"="" "namespace"="" "policy"="policy-qos" "rule"="add-memory-limit" "patch"="{\"spec\": {\"template\": {\"spec\": {\"containers\": [{\"resources\": {\"limits\": {\"cpu\": \"100\", \"memory\": \"300Mi\"}}, name: \"\"}]}}}}\n"
I0818 08:40:03.271151  776972 strategicMergePatch.go:75] EngineForceMutate "msg"="generated patch" "kind"="Deployment" "name"="" "namespace"="" "policy"="policy-qos" "patch"="{\"op\":\"add\",\"path\":\"/spec/template/spec/containers/0/resources/limits/cpu\",\"value\":\"100\"}"
I0818 08:40:03.271203  776972 strategicMergePatch.go:75] EngineForceMutate "msg"="generated patch" "kind"="Deployment" "name"="" "namespace"="" "policy"="policy-qos" "patch"="{\"op\":\"add\",\"path\":\"/spec/template/spec/containers/0/resources/limits/memory\",\"value\":\"300Mi\"}"
I0818 08:40:03.271229  776972 strategicMergePatch.go:75] EngineForceMutate "msg"="generated patch" "kind"="Deployment" "name"="" "namespace"="" "policy"="policy-qos" "patch"="{\"op\":\"remove\",\"path\":\"/spec/template/spec/containers/0/resources/requests\"}"
I0818 08:40:03.271268  776972 strategicMergePatch.go:75] EngineForceMutate "msg"="generated patch" "kind"="Deployment" "name"="" "namespace"="" "policy"="policy-qos" "patch"="{\"op\":\"remove\",\"path\":\"/spec/template/spec/containers/0/args\"}"
I0818 08:40:03.271294  776972 strategicMergePatch.go:75] EngineForceMutate "msg"="generated patch" "kind"="Deployment" "name"="" "namespace"="" "policy"="policy-qos" "patch"="{\"op\":\"remove\",\"path\":\"/spec/template/spec/containers/0/lifecycle\"}"
I0818 08:40:03.271321  776972 strategicMergePatch.go:75] EngineForceMutate "msg"="generated patch" "kind"="Deployment" "name"="" "namespace"="" "policy"="policy-qos" "patch"="{\"op\":\"remove\",\"path\":\"/spec/template/spec/containers/0/startupProbe\"}"
I0818 08:40:03.271345  776972 strategicMergePatch.go:75] EngineForceMutate "msg"="generated patch" "kind"="Deployment" "name"="" "namespace"="" "policy"="policy-qos" "patch"="{\"op\":\"remove\",\"path\":\"/spec/template/spec/containers/0/stdinOnce\"}"
I0818 08:40:03.271371  776972 strategicMergePatch.go:75] EngineForceMutate "msg"="generated patch" "kind"="Deployment" "name"="" "namespace"="" "policy"="policy-qos" "patch"="{\"op\":\"remove\",\"path\":\"/spec/template/spec/containers/0/terminationMessagePolicy\"}"
I0818 08:40:03.271397  776972 strategicMergePatch.go:75] EngineForceMutate "msg"="generated patch" "kind"="Deployment" "name"="" "namespace"="" "policy"="policy-qos" "patch"="{\"op\":\"remove\",\"path\":\"/spec/template/spec/containers/0/workingDir\"}"
I0818 08:40:03.271424  776972 strategicMergePatch.go:75] EngineForceMutate "msg"="generated patch" "kind"="Deployment" "name"="" "namespace"="" "policy"="policy-qos" "patch"="{\"op\":\"remove\",\"path\":\"/spec/template/spec/containers/0/envFrom\"}"
I0818 08:40:03.271451  776972 strategicMergePatch.go:75] EngineForceMutate "msg"="generated patch" "kind"="Deployment" "name"="" "namespace"="" "policy"="policy-qos" "patch"="{\"op\":\"remove\",\"path\":\"/spec/template/spec/containers/0/image\"}"
I0818 08:40:03.271477  776972 strategicMergePatch.go:75] EngineForceMutate "msg"="generated patch" "kind"="Deployment" "name"="" "namespace"="" "policy"="policy-qos" "patch"="{\"op\":\"remove\",\"path\":\"/spec/template/spec/containers/0/imagePullPolicy\"}"
I0818 08:40:03.271505  776972 strategicMergePatch.go:75] EngineForceMutate "msg"="generated patch" "kind"="Deployment" "name"="" "namespace"="" "policy"="policy-qos" "patch"="{\"op\":\"remove\",\"path\":\"/spec/template/spec/containers/0/ports\"}"
I0818 08:40:03.271531  776972 strategicMergePatch.go:75] EngineForceMutate "msg"="generated patch" "kind"="Deployment" "name"="" "namespace"="" "policy"="policy-qos" "patch"="{\"op\":\"remove\",\"path\":\"/spec/template/spec/containers/0/readinessProbe\"}"
I0818 08:40:03.271557  776972 strategicMergePatch.go:75] EngineForceMutate "msg"="generated patch" "kind"="Deployment" "name"="" "namespace"="" "policy"="policy-qos" "patch"="{\"op\":\"remove\",\"path\":\"/spec/template/spec/containers/0/volumeMounts\"}"
I0818 08:40:03.271582  776972 strategicMergePatch.go:75] EngineForceMutate "msg"="generated patch" "kind"="Deployment" "name"="" "namespace"="" "policy"="policy-qos" "patch"="{\"op\":\"remove\",\"path\":\"/spec/template/spec/containers/0/livenessProbe\"}"
I0818 08:40:03.271609  776972 strategicMergePatch.go:75] EngineForceMutate "msg"="generated patch" "kind"="Deployment" "name"="" "namespace"="" "policy"="policy-qos" "patch"="{\"op\":\"remove\",\"path\":\"/spec/template/spec/containers/0/stdin\"}"
I0818 08:40:03.271636  776972 strategicMergePatch.go:75] EngineForceMutate "msg"="generated patch" "kind"="Deployment" "name"="" "namespace"="" "policy"="policy-qos" "patch"="{\"op\":\"remove\",\"path\":\"/spec/template/spec/containers/0/tty\"}"
I0818 08:40:03.271663  776972 strategicMergePatch.go:75] EngineForceMutate "msg"="generated patch" "kind"="Deployment" "name"="" "namespace"="" "policy"="policy-qos" "patch"="{\"op\":\"remove\",\"path\":\"/spec/template/spec/containers/0/command\"}"
I0818 08:40:03.271696  776972 strategicMergePatch.go:75] EngineForceMutate "msg"="generated patch" "kind"="Deployment" "name"="" "namespace"="" "policy"="policy-qos" "patch"="{\"op\":\"remove\",\"path\":\"/spec/template/spec/containers/0/env\"}"
I0818 08:40:03.271738  776972 strategicMergePatch.go:75] EngineForceMutate "msg"="generated patch" "kind"="Deployment" "name"="" "namespace"="" "policy"="policy-qos" "patch"="{\"op\":\"remove\",\"path\":\"/spec/template/spec/containers/0/securityContext\"}"
I0818 08:40:03.271765  776972 strategicMergePatch.go:75] EngineForceMutate "msg"="generated patch" "kind"="Deployment" "name"="" "namespace"="" "policy"="policy-qos" "patch"="{\"op\":\"remove\",\"path\":\"/spec/template/spec/containers/0/terminationMessagePath\"}"
I0818 08:40:03.271790  776972 strategicMergePatch.go:75] EngineForceMutate "msg"="generated patch" "kind"="Deployment" "name"="" "namespace"="" "policy"="policy-qos" "patch"="{\"op\":\"remove\",\"path\":\"/spec/template/spec/containers/0/volumeDevices\"}"
I0818 08:40:03.271818  776972 strategicMergePatch.go:28] EngineForceMutate/ProcessStrategicMergePatch "msg"="finished applying strategicMerge patch" "kind"="Deployment" "name"="" "namespace"="" "policy"="policy-qos" "rule"="add-memory-limit" "processingTime"="13.004727ms"
I0818 08:40:03.272710  776972 logr.go:261]  "msg"="applying policy on resource"  "policy"="policy-qos" "resource"="default/Deployment/qos-demo"
I0818 08:40:03.273292  776972 logr.go:261]  "msg"="updated image info"  "images"={"containers":{"nginx":{"registry":"docker.io","name":"nginx","path":"nginx","tag":"latest"}}}
I0818 08:40:03.273593  776972 logr.go:261]  "msg"="applied JSON patch"  "patch"=[{"op":"replace","path":"/spec/template/spec/containers/0/image","value":"docker.io/nginx:latest"}]
I0818 08:40:03.274193  776972 mutation.go:33] EngineMutate "msg"="start mutate policy processing" "kind"="Deployment" "name"="qos-demo" "namespace"="default" "policy"="policy-qos" "startTime"="2022-08-18T08:40:03.274165645+05:30"
I0818 08:40:03.333022  776972 mutation.go:61] EngineMutate "msg"="processing mutate rule" "kind"="Deployment" "name"="qos-demo" "namespace"="default" "policy"="policy-qos" "rule"="add-memory-limit" "applyRules"="All"
I0818 08:40:03.336198  776972 mutation.go:108] EngineMutate "msg"="apply rule to resource" "kind"="Deployment" "name"="qos-demo" "namespace"="default" "policy"="policy-qos" "resource name"="qos-demo" "resource namespace"="default" "rule"="add-memory-limit"
I0818 08:40:03.341243  776972 strategicMergePatch.go:21] EngineMutate/ProcessStrategicMergePatch "msg"="started applying strategicMerge patch" "kind"="Deployment" "name"="qos-demo" "namespace"="default" "policy"="policy-qos" "rule"="add-memory-limit" "startTime"="2022-08-18T08:40:03.341127245+05:30"
I0818 08:40:03.342195  776972 strategicMergePatch.go:100] EngineMutate/ProcessStrategicMergePatch "msg"="applying strategic merge patch" "kind"="Deployment" "name"="qos-demo" "namespace"="default" "policy"="policy-qos" "rule"="add-memory-limit" "patch"="{\"spec\": {\"template\": {\"spec\": {\"containers\": [{\"resources\": {\"limits\": {\"memory\": \"300Mi\"}}, name: \"nginx\"}]}}}}\n"
I0818 08:40:04.196129  776972 strategicMergePatch.go:75] EngineMutate "msg"="generated patch" "kind"="Deployment" "name"="qos-demo" "namespace"="default" "policy"="policy-qos" "rule"="add-memory-limit" "patch"="{\"op\":\"add\",\"path\":\"/spec/template/spec/containers/0/resources/limits/memory\",\"value\":\"300Mi\"}"
I0818 08:40:04.196188  776972 strategicMergePatch.go:28] EngineMutate/ProcessStrategicMergePatch "msg"="finished applying strategicMerge patch" "kind"="Deployment" "name"="qos-demo" "namespace"="default" "policy"="policy-qos" "rule"="add-memory-limit" "processingTime"="855.036844ms"
I0818 08:40:04.196849  776972 mutation.go:319] EngineMutate "msg"="finished processing policy" "kind"="Deployment" "name"="qos-demo" "namespace"="default" "policy"="policy-qos" "mutationRulesApplied"=1 "processingTime"="922.655855ms"
I0818 08:40:04.196916  776972 validation.go:33] EngineValidate "msg"="start validate policy processing" "kind"="Deployment" "name"="qos-demo" "namespace"="default" "policy"="policy-qos" "startTime"="2022-08-18T08:40:04.196886198+05:30"
I0818 08:40:04.196996  776972 validation.go:109] EngineValidate "msg"="processing validation rule" "kind"="Deployment" "name"="qos-demo" "namespace"="default" "policy"="policy-qos" "rule"="check-cpu-memory-limits" "applyRules"="All" "matchCount"=0
I0818 08:40:04.197634  776972 validation.go:516] EngineValidate "msg"="successfully processed rule" "kind"="Deployment" "name"="qos-demo" "namespace"="default" "policy"="policy-qos" "rule"="check-cpu-memory-limits" 
I0818 08:40:04.197662  776972 validation.go:159] EngineValidate "msg"="finished processing rule" "kind"="Deployment" "name"="qos-demo" "namespace"="default" "policy"="policy-qos" "rule"="check-cpu-memory-limits" "processingTime"="643.035µs"
I0818 08:40:04.197681  776972 validation.go:36] EngineValidate "msg"="finished policy processing" "kind"="Deployment" "name"="qos-demo" "namespace"="default" "policy"="policy-qos" "processingTime"="783.186µs" "validationRulesApplied"=1
I0818 08:40:04.197706  776972 imageVerify.go:40] EngineVerifyImages "msg"="processed image verification rules" "kind"="Deployment" "name"="qos-demo" "namespace"="default" "policy"="policy-qos" "applied"=0 "successful"=true "time"="1.675µs"
I0818 08:40:04.198089  776972 logr.go:261]  "msg"="Pattern and resource have different structures."  "current"="<nil>" "expected"="map[string]interface {}" "path"="/status/"
I0818 08:40:04.198110  776972 logr.go:261]  "msg"="patchedResource mismatch"  "error"="pattern and resource have different structures. Path: /status/. Expected map[string]interface {}, found <nil>"
I0818 08:40:04.198206  776972 logr.go:261]  "msg"="result mismatch"  "expected"="pass" "key"="policy-qos-add-memory-limit-Deployment-qos-demo" "received"="fail"
